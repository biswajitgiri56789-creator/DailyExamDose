name: 24/7 Daily Exam Dose Bot

on:
  # à¦®à§à¦¯à¦¾à¦¨à§à¦¯à¦¼à¦¾à¦²à¦¿ à¦°à¦¾à¦¨ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯
  workflow_dispatch:
  
  # à¦¸à§à¦¬à¦¯à¦¼à¦‚à¦•à§à¦°à¦¿à¦¯à¦¼à¦­à¦¾à¦¬à§‡ à¦ªà§à¦°à¦¤à¦¿ à§©à§¦ à¦®à¦¿à¦¨à¦¿à¦Ÿà§‡ à¦°à¦¾à¦¨ à¦•à¦°à¦¬à§‡
  schedule:
    - cron: '*/30 * * * *'

jobs:
  run-bot:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“‚ Checkout Repository
        uses: actions/checkout@v4
        
      - name: ðŸ Setup Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          
      - name: ðŸ“¦ Install Dependencies
        run: |
          pip install python-telegram-bot
          
      - name: ðŸ”§ Verify Setup
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          echo "ðŸ”§ System Information:"
          echo "Python version: $(python --version)"
          echo "Working directory: $(pwd)"
          echo "Files in directory:"
          ls -la
          
          echo -e "\nðŸ” Secrets Check:"
          if [ -z "$BOT_TOKEN" ]; then
            echo "âŒ ERROR: BOT_TOKEN is empty!"
            exit 1
          else
            echo "âœ… BOT_TOKEN is set (length: ${#BOT_TOKEN})"
          fi
          
          if [ -z "$CHAT_ID" ]; then
            echo "âŒ ERROR: CHAT_ID is empty!"
            exit 1
          else
            echo "âœ… CHAT_ID: $CHAT_ID"
          fi
          
      - name: ðŸ¤– Run Simple Bot
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          echo "ðŸš€ Starting Simple Bot Script..."
          
          # Create a simple bot script
          cat > simple_bot.py << 'EOF'
import os
import sys
import random
from datetime import datetime
import requests

def send_question():
    BOT_TOKEN = os.environ.get('BOT_TOKEN')
    CHAT_ID = os.environ.get('CHAT_ID')
    
    print(f"âœ… Using BOT_TOKEN: {BOT_TOKEN[:10]}...")
    print(f"âœ… Using CHAT_ID: {CHAT_ID}")
    
    # Question templates
    questions = [
        {
            "subject": "Physics",
            "question": "What is Newton's First Law of Motion?",
            "options": ["A. Inertia", "B. Force = mass Ã— acceleration", "C. Action-Reaction", "D. Gravitation"],
            "answer": "A"
        },
        {
            "subject": "Chemistry",
            "question": "What is the atomic number of Carbon?",
            "options": ["A. 6", "B. 12", "C. 14", "D. 8"],
            "answer": "A"
        },
        {
            "subject": "Mathematics",
            "question": "What is the value of Ï€ (pi) approximately?",
            "options": ["A. 3.14159", "B. 2.71828", "C. 1.61803", "D. 1.41421"],
            "answer": "A"
        },
        {
            "subject": "à¦¬à¦¾à¦‚à¦²à¦¾",
            "question": "à¦¬à¦¾à¦‚à¦²à¦¾ à¦¸à¦¾à¦¹à¦¿à¦¤à§à¦¯à§‡à¦° à¦ªà§à¦°à¦¥à¦® à¦‰à¦ªà¦¨à§à¦¯à¦¾à¦¸ à¦•à§‹à¦¨à¦Ÿà¦¿?",
            "options": ["à¦•. à¦†à¦²à¦¾à¦²à§‡à¦° à¦˜à¦°à§‡à¦° à¦¦à§à¦²à¦¾à¦²", "à¦–. à¦•à¦ªà¦¾à¦²à¦•à§à¦£à§à¦¡à¦²à¦¾", "à¦—. à¦¦à§à¦°à§à¦—à§‡à¦¶à¦¨à¦¨à§à¦¦à¦¿à¦¨à§€", "à¦˜. à¦…à¦¨à§à¦°à¦¾à¦§à¦¾"],
            "answer": "à¦•"
        }
    ]
    
    # Select random question
    q = random.choice(questions)
    
    # Create message
    message = f"""
ðŸ“š *Daily Exam Dose*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“… à¦¤à¦¾à¦°à¦¿à¦–: {datetime.now().strftime('%d/%m/%Y')}
ðŸ• à¦¸à¦®à¦¯à¦¼: {datetime.now().strftime('%I:%M %p')}
ðŸŽ¯ à¦ªà§à¦°à¦¶à§à¦¨ à¦¨à¦‚: {random.randint(1, 50000)}
ðŸ“– à¦¬à¦¿à¦·à¦¯à¦¼: {q['subject']}
ðŸ« à¦¶à§à¦°à§‡à¦£à§€: {random.choice(['à¦à¦•à¦¾à¦¦à¦¶', 'à¦¦à§à¦¬à¦¾à¦¦à¦¶', 'à¦•à¦²à§‡à¦œ'])}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â“ à¦ªà§à¦°à¦¶à§à¦¨: {q['question']}

{q['options'][0]}
{q['options'][1]}
{q['options'][2]}
{q['options'][3]}

âœ… à¦‰à¦¤à§à¦¤à¦°: {q['answer']}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ’¡ à¦ªà¦°à¦¾à¦®à¦°à§à¦¶: à¦¨à¦¿à¦¯à¦¼à¦®à¦¿à¦¤ à¦…à¦¨à§à¦¶à§€à¦²à¦¨ à¦•à¦°à§à¦¨
â° à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦ªà§à¦°à¦¶à§à¦¨: à§©à§¦ à¦®à¦¿à¦¨à¦¿à¦Ÿ à¦ªà¦°
"""
    
    # Send to Telegram
    url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
    data = {
        "chat_id": CHAT_ID,
        "text": message,
        "parse_mode": "Markdown"
    }
    
    try:
        import requests
        response = requests.post(url, json=data, timeout=10)
        result = response.json()
        
        if result.get('ok'):
            print(f"âœ… Success! Message ID: {result['result']['message_id']}")
            return True
        else:
            print(f"âŒ Error: {result.get('description')}")
            return False
            
    except Exception as e:
        print(f"âŒ Exception: {e}")
        return False

if __name__ == "__main__":
    print("ðŸš€ Daily Exam Dose Bot Started...")
    success = send_question()
    if success:
        print("ðŸŽ‰ Bot completed successfully!")
        sys.exit(0)
    else:
        print("ðŸ’¥ Bot failed!")
        sys.exit(1)
EOF
          
          # Run the bot
          python simple_bot.py
          
      - name: âœ… Success Report
        if: success()
        run: |
          echo "ðŸŽ‰ Bot ran successfully!"
          echo "ðŸ“¤ Question posted to Telegram channel"
          echo "â° Next run: After 30 minutes"
          echo "ðŸ“… Current time: $(date)"
          
      - name: âŒ Error Report
        if: failure()
        run: |
          echo "âš ï¸ Bot failed to run!"
          echo "ðŸ”§ Please check the logs above for error details"
          echo "ðŸ’¡ Common issues:"
          echo "1. Check BOT_TOKEN in GitHub Secrets"
          echo "2. Check CHAT_ID in GitHub Secrets"
          echo "3. Bot should be admin in Telegram channel"
          echo "4. Check network connectivity"
